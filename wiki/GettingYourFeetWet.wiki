#summary Introduction to Siebel-COM

= Introduction =

Siebel-COM is an Perl API to add "syntax sugar" to connect to a Siebel application. By using classes created with [http://search.cpan.org/perldoc?Moose Moose] (and internally [http://search.cpan.org/perldoc?Win32::OLE Win32::OLE]) you can access Siebel without having to go down the details of using Siebel COM (Data Server and/or Data Control) and COM concepts.

Siebel-COM is also available at [http://search.cpan.org CPAN]. You can get the latest [http://search.cpan.org/perldoc?Siebel::COM documentation] of with from the Perldoc generated from the packages.

= Details =

Here is an example of updating accounts in Siebel with Siebel::App::!DataControl:

{{{
  use feature 'say';
  use Siebel::COM::App::DataControl;
  use TryCatch;

  my $input_file = shift;
  chomp($input_file);

  open( my $input, '<', $input_file ) or die "Cannot read $input_file: $!\n";
  my @lines = <$input>;
  close($input);

  my $app = Siebel::COM::App::DataControl->new(
      {
          user       => 'sadmin',
          password   => 'sadmin',
          host       => 'foobar',
          enterprise => 'SIEBEL',
          lang       => 'ENU',
          aom        => 'eCommunicationsObjMgr_enu'
      }
  );

  try {

      $app->login();

      my $bo = $app->get_bus_object('Account');
      my $bc = $bo->get_bus_comp('Account');

      $bc->activate_field('Location');
      $bc->activate_field('Extension Phone Number');

      foreach my $loc (@lines) {

          chomp($loc);

          $bc->clear_query();
          $bc->set_view_mode();

          $bc->set_search_spec( 'Location', "='$loc'" );
          $bc->query();

          if ( $bc->first_record() ) {

              do {

                  my $val = $bc->get_field_value('Location');
  
                  if ( defined($val) ) {

                      $bc->set_field_value( 'Extension Phone Number', '' );
                      $bc->write_record();

                  }

                  say 'updated';

              } while ( $bc->next_record() )

          }
          else {

              say 'Could not find the account';

          }

      }

  }
  catch {

      die 'Exception: ' . $app->get_last_error();

  }
}}}